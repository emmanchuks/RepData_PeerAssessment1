---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
---

title: "Reproducible Research: Peer Assessment 1"
author: "Ezeonyebuchi Emmanuel Chukwuma"
date: "20 March 2019"
output:
html_document:
   keep_md:true

---
      
      
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set( fig.path = "figure/")

```
---
```{r}

#Set working directory
#setwd("./data")

#install packages
#install.packages("knitr")
#install.packages("rmarkdown")
library(knitr)
library(dplyr)
library(lubridate)

#Create directoty for file if it does'nt already exist
fileURL <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
if (!file.exists("data")) {
  dir.create("data")}
if (!file.exists("PA1_template.md")) {
  dir.create("PA1_template.md")}

#Download data file
#file <- download.file(fileURL, destfile = "./data/acivity.csv", method="auto")
dateDownloaded <- date()
dateDownloaded

#List the file(s)
list.files("./data")

#Extract file from zipped file
# File unzip verification. If the directory does not exist, unzip the downloaded file.
if(!file.exists("./data")){
  unzip("./data", files = NULL, exdir=".")
}

#Read file
activity_Data <- read.csv("activity.csv")

#show the file (activity_Data)
#activity_Data

#Look at the heading
head(activity_Data)

#Check the number of columns
ncol(activity_Data)

#Look at the number of rows
nrow(activity_Data)

#Look at the summary
summary(activity_Data)

#Look at the names of th columns
names(activity_Data)

#Look at the last entries of the data frame
tail(activity_Data)

#Converte activit_Data to date class using package, zoo
activity_Data$date <- as.Date(activity_Data$date, format = "%Y-%m-%d")
suppressWarnings(library(zoo))

is.regular(activity_Data$date)
unique(activity_Data$date)

#Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)
sum(is.na(activity_Data))
#2304

#Create a new dataset that is equal to the original dataset but with the missing data filled in.
activity_data <- activity_Data
sapply(activity_data, class)

##     steps      date  interval 
## "integer"    "Date" "integer"
activity_data$steps[is.na(activity_data$steps)] <- mean(na.omit(activity_Data$steps))
activity_data$date <- as.Date(activity_data$date, format = "%Y-%m-%d")

## What is mean total number of steps taken per day?
#Question 0
#What is mean total number of steps taken per day?
#Calculating the total number of steps taken per day
colMeans(is.na(activity_Data))
steps_per_day <- aggregate(steps ~ date, rm.na = TRUE, data = activity_Data, FUN = sum)

#Plot the histogram, missing values are not omitted
plot(steps_per_day, type = "h", lwd = 10, lend = "square")

#Calculate and report the mean and median of the total number of steps taken per day.
m <- plot(aggregate(steps ~ date, data = activity_Data, FUN = mean))

n <- plot(aggregate(steps ~ date, data = activity_Data, FUN = median))

## What is the average daily activity pattern?
#What is the average daily activity pattern 
#Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
plot(aggregate(steps ~ interval, data = activity_Data, FUN = mean), type = "l")

#Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
#Using the base function max
max(activity_Data$steps, na.rm = TRUE)
#806

## Imputing missing values
#Make a histogram of the total number of steps taken each day 
#and Calculate and report the mean and median total number of steps taken per day. 
#Do these values differ from the estimates from the first part of the assignment? 
#What is the impact of imputing missing data on the estimates of the total daily number of steps?

steps_per_day2 <- aggregate(steps ~ date, rm.na = TRUE, data = activity_data, FUN = sum)
par(mfrow = c(1, 2))
plot(steps_per_day, type = "h", lwd = 5,lend = "square", main = "With NAs")
abline(h = seq(0, 20000, 2500), lty = "dashed")
plot(steps_per_day2, type = "h", lwd = 5, lend = "square", main = "NAs filled")
abline(h = seq(0, 20000, 2500), lty = "dashed")
#dev.off()

#The distribution shape seems to change and become more clustered about its mean. The mean, median, and standard deviation changed after imputing missing values.
cbind(rbind(summary(steps_per_day$steps)[c("Mean", "Median")],
            summary(steps_per_day2$steps)[c("Mean", "Median")]), 
      data.frame(SD = c(sd(steps_per_day$steps, na.rm = TRUE), sd(steps_per_day2$steps))))



## Are there differences in activity patterns between weekdays and weekends?
#Are there differences in activity patterns between weekdays and weekends?
activity_data$weekday <- factor(format(activity_data$date, "%A"))

levels(activity_data$weekday) <- list(weekday = c("Monday", "Tuesday",
                                              "Wednesday", "Thursday",
                                              "Friday"), weekend =
                                    c("Saturday", "Sunday"))

#Make a panel plot containing a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) 
#and the average number of steps taken, averaged across all weekday days or weekend days (y-axis). 
#See the README file in the GitHub repository to see an example of what this plot should look like 
#using simulated data.
par(mfrow = c(2, 1))

with(activity_data[activity_data$weekday == "weekend",], plot(aggregate(steps ~ interval, FUN = mean), type = "l", main = "Weekends"))

with(activity_data[activity_data$weekday == "weekday",], plot(aggregate(steps ~ interval, FUN = mean), type = "l", main = "Weekdays"))
dev.off

